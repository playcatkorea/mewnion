# 🚀 Mewnion 배포 가이드

## ✅ 완료된 작업

### 코드 구현 완료
- ✅ 온보딩 시스템 (4단계)
- ✅ 마이페이지 (프로필, 통계, 고양이, 설정 탭)
- ✅ 홈 캣룸 프리뷰
- ✅ 약관/개인정보방침 링크 수정
- ✅ 소셜 로그인 리서치 및 문서화
- ✅ 프로젝트 빌드 성공 확인

---

## 📋 배포 단계별 가이드

### **1단계: Supabase 데이터베이스 마이그레이션** 🗄️

새로운 테이블과 컬럼을 추가해야 합니다.

#### 실행 방법:
1. [Supabase Dashboard](https://supabase.com/dashboard) 접속
2. 프로젝트 선택
3. 왼쪽 메뉴 → **SQL Editor** 클릭
4. **New query** 버튼 클릭
5. `supabase-onboarding-schema.sql` 파일 내용 전체 복사
6. SQL Editor에 붙여넣기
7. **RUN** 버튼 클릭

#### 추가되는 내용:
- **profiles 테이블 확장**
  - `display_name` (표시 이름)
  - `bio` (자기소개)
  - `gender` (성별)
  - `birth_date` (생년월일)
  - `onboarding_completed` (온보딩 완료 여부)
  - `avatar_url` (프로필 이미지 URL)

- **새 테이블 생성**
  - `cats` (고양이 정보)
  - `user_preferences` (사용자 환경설정)
  - `user_settings` (코인/활동 통계)

- **보안 설정**
  - RLS (Row Level Security) 정책
  - 자동 프로필 생성 트리거

---

### **2단계: 로컬 테스트** 🧪

#### 개발 서버 실행:
```bash
npm run dev
```

#### 테스트 체크리스트:
- [ ] 회원가입 → 온보딩 4단계 완료 → 홈 이동
- [ ] 구글 OAuth 로그인 → 온보딩으로 리디렉션
- [ ] 로그인 후 홈에서 캣룸 프리뷰 표시
- [ ] 헤더에서 사용자명 클릭 → 마이페이지 이동
- [ ] 마이페이지 4개 탭 전환 (프로필, 통계, 고양이, 설정)
- [ ] 회원가입 페이지 약관/개인정보방침 링크 클릭

---

### **3단계: 프로덕션 빌드** 🔨

#### 빌드 실행:
```bash
npm run build
```

#### 빌드 결과 확인:
- ✅ 빌드 성공 (4.29초)
- ✅ 211개 모듈 변환 완료
- ✅ `out/` 디렉토리에 정적 파일 생성
- ⚠️ TypeScript 경고 (무시 가능)

#### 로컬 프리뷰:
```bash
npm run preview
```
브라우저에서 `http://localhost:4173` 접속하여 프로덕션 빌드 테스트

---

### **4단계: 배포 플랫폼 선택** 🌐

추천 플랫폼 및 방법:

#### **Option A: Vercel (추천)** ⭐

**장점:**
- Vite/React 최적화
- 자동 HTTPS
- 무료 호스팅
- GitHub 연동 자동 배포

**배포 방법:**
1. [Vercel](https://vercel.com) 접속 및 로그인
2. **New Project** 클릭
3. GitHub 리포지토리 선택
4. **Build Command**: `npm run build`
5. **Output Directory**: `out`
6. 환경 변수 설정:
   - `VITE_SUPABASE_URL`: Supabase 프로젝트 URL
   - `VITE_SUPABASE_ANON_KEY`: Supabase anon public key
7. **Deploy** 클릭

**CLI 배포:**
```bash
# Vercel CLI 설치
npm i -g vercel

# 배포
vercel

# 프로덕션 배포
vercel --prod
```

---

#### **Option B: Netlify**

**배포 방법:**
1. [Netlify](https://www.netlify.com) 접속 및 로그인
2. **Add new site** → **Import an existing project**
3. GitHub 리포지토리 연결
4. **Build command**: `npm run build`
5. **Publish directory**: `out`
6. 환경 변수 설정 (Vercel과 동일)
7. **Deploy** 클릭

---

#### **Option C: GitHub Pages**

**배포 방법:**
```bash
# gh-pages 패키지 설치
npm install -D gh-pages

# package.json에 추가
# "scripts": {
#   "deploy": "gh-pages -d out"
# }

# 배포
npm run deploy
```

**주의:** GitHub Pages는 SPA 라우팅을 위해 추가 설정 필요 (404.html 리디렉션)

---

### **5단계: 환경 변수 설정** 🔐

배포 플랫폼에서 다음 환경 변수 설정:

| 변수명 | 값 | 설명 |
|--------|------|------|
| `VITE_SUPABASE_URL` | `https://[프로젝트ID].supabase.co` | Supabase 프로젝트 URL |
| `VITE_SUPABASE_ANON_KEY` | `eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...` | Supabase anon public key |

**Supabase 키 확인 방법:**
1. [Supabase Dashboard](https://supabase.com/dashboard)
2. 프로젝트 선택
3. **Settings** → **API**
4. **Project URL**과 **anon public** 키 복사

---

### **6단계: Supabase 설정 업데이트** 🔒

#### Redirect URLs 추가:
1. Supabase Dashboard → **Authentication** → **URL Configuration**
2. **Redirect URLs**에 추가:
   ```
   https://[your-domain].vercel.app/auth/callback
   https://[your-domain].netlify.app/auth/callback
   ```

#### Site URL 설정:
```
https://[your-domain].vercel.app
```

---

### **7단계: 배포 후 확인** ✅

배포된 사이트에서 다음 항목 테스트:

- [ ] 메인 페이지 로딩
- [ ] 회원가입 → 온보딩 → 홈
- [ ] 로그인 → 마이페이지
- [ ] 구글 OAuth 로그인
- [ ] 캣룸 프리뷰 표시
- [ ] 모든 라우트 접근 가능
- [ ] HTTPS 적용 확인

---

## 🎯 다음 단계 (선택사항)

### 소셜 로그인 추가하기

현재 리서치 완료된 소셜 로그인 제공자:

#### Supabase 대시보드에서 바로 설정 가능:
- Google ✅ (현재 사용 중)
- Apple
- GitHub
- Facebook
- Twitter (X)
- Discord
- Microsoft
- LinkedIn

#### Edge Function 필요 (한국 서비스):
- Kakao
- Naver
- Line

자세한 내용: `Supabase_소셜_로그인_가이드.md` 참조

### 2단계 인증 (2FA) 추가하기

TOTP 기반 2FA 구현 가이드: `마이페이지_및_소셜로그인_완료.md` 참조

---

## 🐛 문제 해결

### 빌드 오류 발생 시:
```bash
# 캐시 삭제
rm -rf node_modules
npm install

# 다시 빌드
npm run build
```

### 환경 변수 인식 안될 때:
- `.env` 파일이 아닌 배포 플랫폼 대시보드에서 설정
- 변수명이 `VITE_` 접두사로 시작하는지 확인
- 배포 플랫폼에서 재배포 (환경 변수 변경 후)

### OAuth 리디렉션 오류:
- Supabase Dashboard에서 Redirect URL 정확히 입력했는지 확인
- URL 끝에 `/` 포함 여부 확인
- HTTPS 사용 확인

### 데이터베이스 오류:
- SQL 마이그레이션 정상 실행되었는지 확인
- RLS 정책이 활성화되어 있는지 확인
- Supabase Dashboard → **Table Editor**에서 테이블 존재 확인

---

## 📞 지원

문제가 발생하면 다음 문서를 참조하세요:

- `온보딩_시스템_설정_가이드.md`
- `Supabase_소셜_로그인_가이드.md`
- `마이페이지_및_소셜로그인_완료.md`
- [Supabase 공식 문서](https://supabase.com/docs)
- [Vite 배포 가이드](https://vitejs.dev/guide/static-deploy.html)

---

## 🎉 배포 완료!

축하합니다! Mewnion이 성공적으로 배포되었습니다.

다음 기능 개발을 원하시면 언제든 말씀해주세요! 🐱
